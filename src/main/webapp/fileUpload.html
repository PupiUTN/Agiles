<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
<head>
    <title>TODO supply a title</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<h1>File Upload Example - howtodoinjava.com</h1>

<!--<form method="POST" enctype="multipart/form-data" action="/api/file/">-->
<!--<table>-->
<!--<tr><td>File to upload:</td><td><input type="file" name="file" /></td></tr>-->
<!--<tr><td></td><td><input type="submit" value="Upload" /></td></tr>-->
<!--</table>-->
<!--</form>-->


<form enctype="multipart/form-data">
    <input name="file" type="file"/>
    <input type="button" value="Upload 5"/>
</form>

<script src="js/jquery-2.1.1.min.js"></script>


</body>

<script>
    $(':file').on('change', function () {
        var file = this.files[0];
        if (file.size > 1048576 ){
            alert('max upload size is 1 mb')
        }

        // Also see .name, .type
    });

    $(':button').on('click', function() {
        $.ajax({
            // Your server script to process the upload
            url: '/api/file/',
            type: 'POST',

            // Form data
            data: new FormData($('form')[0]),

            // Tell jQuery not to process data or worry about content-type
            // You *must* include these options!
            cache: false,
            contentType: false,
            processData: false,
            success: function (data) {
                console.log(data);

            },

            // Custom XMLHttpRequest
            xhr: function() {
                var myXhr = $.ajaxSettings.xhr();
                if (myXhr.upload) {
                    console.log("subiendo " +myXhr);

                    // For handling the progress of the upload
                    myXhr.upload.addEventListener('progress', function(e) {
                        if (e.lengthComputable) {
                            $('progress').attr({
                                value: e.loaded,
                                max: e.total,
                            });
                        }
                    } , false);
                }
                return myXhr;
            },
        });
    });

</script>

</html>
